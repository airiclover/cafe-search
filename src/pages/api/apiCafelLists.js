import fetch from "node-fetch";
import { lat, lng } from "../../pages/index";

// ãƒ›ãƒƒãƒˆãƒšãƒƒãƒ‘ãƒ¼APIã¯ã€ã‚µãƒ¼ãƒãƒ¼å´ã§ã®ã¿ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒå¯ã€‚
// ç¾åœ¨åœ°å–å¾—å¾Œãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒã—ãŸã„ãŒã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ï¼ˆJavaScriptã«ã‚ˆã£ã¦ãƒ–ãƒ©ã‚¦ã‚¶å´ï¼‰ã§ã¯ä¸å¯ã®ãŸã‚ã€CORSã«ã‚ˆã‚Šãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã—ã¾ã†ã€‚
// =====â“ã©ã†ã™ã‚‹ã‹â“=====
// ðŸ‘‰CSRã§ãƒ–ãƒ©ã‚¦ã‚¶ã§ãƒšãƒ¼ã‚¸ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å¾Œã€getCurrentPositioné–¢æ•°ã«ã¦ã€Œç·¯åº¦ãƒ»è»½åº¦ã€ã‚’å–å¾—

// ðŸ‘‰å–å¾—ã—ãŸã€Œç·¯åº¦ãƒ»è»½åº¦ã€ã‚’ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«æ¸¡ã—ãŸã„
// ã€€ðŸ‘†ã“ã‚Œç„¡ç†ã˜ã‚ƒã­ï¼Ÿï¼Ÿï¼Ÿ
//    ãƒœã‚¿ãƒ³æŠ¼ã•ã‚Œã‚‹åº¦ã«ã€æ–°ãŸãªç·¯åº¦ãƒ»è»½åº¦ã‚’æ¸¡ã™å¿…è¦ã‚ã‚‹ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒå¯èƒ½ãªã‚‰useStateã¨useEffectã‹useSWRã‚’ç”¨ã„ã¦å®Ÿè£…ã§ãã‚‹ï¼ˆã—ãŸã„ï¼‰ãŒã€ã‚µãƒ¼ãƒãƒ¼å´ã«ãƒ‡ãƒ¼ã‚¿æ¸¡ã—ã¦ãƒ•ã‚§ãƒƒãƒã—ã¦ã¨ãªã‚‹ã¨ã‚¹ã‚³ãƒ¼ãƒ—å•é¡Œã‚„æ–°ãŸãªç·¯åº¦è»½åº¦ã‚’exportã§ããªããªã„ã‹ã€ã€ã€ï¼Ÿåˆ†ã‹ã‚‰ã‚“ã‘ã©ã€ã€ã€

// ðŸ‘‰å—ã‘å–ã£ãŸã€Œç·¯åº¦ãƒ»è»½åº¦ã€ã‹ã‚‰"node-fetch"ã‚’ç”¨ã„ã¦ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã«ã¦ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒ
// ã€€ï¼ˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§getApié–¢æ•°ã«ã¦ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒã—ãŸã„ãŸã‚ï¼‰

// ðŸ‘‰ç¾åœ¨åœ°ã§å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ã€ŒuseStateã€ãªã©ã‚’ç”¨ã„ã¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«æ¸¡ã—ã€è¡¨ç¤ºã•ã›ãŸã„

export default (req, res) => {
  console.log("aaaaaaa");

  const LAT = lat;
  const LNG = lng;

  res.statusCode = 200;
  fetch(
    `http://webservice.recruit.co.jp/hotpepper/gourmet/v1/?key=ed1b3ecc1ac15f32&lat=${LAT}&lng=${LNG}&genre=G014&format=json`
  )
    .then((r) => r.json())
    .then((data) => res.json(data.results.shop));
};

// export default (req, res) => {
//   res.statusCode = 200;
//   fetch(
//     "http://webservice.recruit.co.jp/hotpepper/gourmet/v1/?key=ed1b3ecc1ac15f32&lat=35.66922&lng=139.761457&genre=G014&format=json"
//   )
//     .then((r) => r.json())
//     .then((data) => res.json(data.results.shop));
// };
